<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="Panomi.UI.Views.LibraryPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:Panomi.UI.Views"
    Background="Transparent">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <TextBlock 
            Grid.Row="0"
            Text="Game Library" 
            Style="{StaticResource TitleTextBlockStyle}"
            Margin="0,0,0,16"/>

        <!-- Toolbar -->
        <Grid Grid.Row="1" Margin="0,0,0,16">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <AutoSuggestBox 
                x:Name="SearchBox"
                Grid.Column="0"
                PlaceholderText="Search games..."
                QueryIcon="Find"
                Width="300"
                HorizontalAlignment="Left"
                TextChanged="SearchBox_TextChanged"/>

            <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="8">
                <Button x:Name="RefreshButton" Click="RefreshButton_Click" ToolTipService.ToolTip="Scan for games">
                    <FontIcon Glyph="&#xE72C;" FontSize="16"/>
                </Button>
                <Button x:Name="AddGameButton" Click="AddGameButton_Click" ToolTipService.ToolTip="Add game manually">
                    <FontIcon Glyph="&#xE710;" FontSize="16"/>
                </Button>
            </StackPanel>
        </Grid>

        <!-- Game Grid -->
        <GridView 
            x:Name="GamesGrid"
            Grid.Row="2"
            ItemsSource="{x:Bind Games, Mode=OneWay}"
            SelectionMode="Single"
            IsItemClickEnabled="True"
            ItemClick="GamesGrid_ItemClick">
            
            <GridView.ItemTemplate>
                <DataTemplate>
                    <Grid Width="180" Height="240" Margin="4" CornerRadius="8" Background="{ThemeResource CardBackgroundFillColorDefaultBrush}">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Game Icon/Cover -->
                        <Border Grid.Row="0" CornerRadius="8,8,0,0">
                            <Grid>
                                <FontIcon 
                                    Glyph="&#xE7FC;" 
                                    FontSize="48" 
                                    Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    Visibility="{Binding HasIcon, Converter={StaticResource BoolToVisibilityInverseConverter}}"/>
                                <Image 
                                    Source="{Binding IconPath}" 
                                    Stretch="UniformToFill"
                                    Visibility="{Binding HasIcon, Converter={StaticResource BoolToVisibilityConverter}}"/>
                            </Grid>
                        </Border>

                        <!-- Game Info -->
                        <StackPanel Grid.Row="1" Padding="12,8">
                            <TextBlock 
                                Text="{Binding Name}" 
                                Style="{StaticResource BodyStrongTextBlockStyle}"
                                TextWrapping="Wrap"
                                TextTrimming="CharacterEllipsis"
                                MaxLines="2"/>
                            <TextBlock 
                                Text="{Binding LauncherName}" 
                                Style="{StaticResource CaptionTextBlockStyle}"
                                Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                Visibility="{Binding HasMultipleLaunchers, Converter={StaticResource BoolToVisibilityConverter}}"/>
                        </StackPanel>
                    </Grid>
                </DataTemplate>
            </GridView.ItemTemplate>
        </GridView>

        <!-- Empty State -->
        <StackPanel 
            x:Name="EmptyState"
            Grid.Row="2"
            HorizontalAlignment="Center"
            VerticalAlignment="Center"
            Visibility="Collapsed">
            <FontIcon Glyph="&#xE7FC;" FontSize="64" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
            <TextBlock 
                Text="No games found" 
                Style="{StaticResource SubtitleTextBlockStyle}"
                HorizontalAlignment="Center"
                Margin="0,16,0,8"/>
            <TextBlock 
                Text="Click the refresh button to scan for installed games"
                Style="{StaticResource BodyTextBlockStyle}"
                Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                HorizontalAlignment="Center"/>
        </StackPanel>
    </Grid>
</Page>
